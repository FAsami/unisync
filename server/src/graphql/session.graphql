# Session Queries
query GetSession($id: uuid!) {
  user_session_by_pk(id: $id) {
    id
    user_id
    access_token
    access_token_expires_at
    refresh_token
    refresh_token_expires_at
    revoked
    ip_address
    device_info
    user_agent
    last_used_at
    created_at
    updated_at
  }
}

query GetSessions($limit: Int, $offset: Int) {
  user_session(limit: $limit, offset: $offset, order_by: { created_at: desc }) {
    id
    user_id
    access_token
    access_token_expires_at
    refresh_token
    refresh_token_expires_at
    revoked
    ip_address
    device_info
    user_agent
    last_used_at
    created_at
    updated_at
  }
}

# Session Mutations
mutation InsertSession($session: user_session_insert_input!) {
  insert_user_session_one(object: $session) {
    id
    user_id
    access_token
    access_token_expires_at
    refresh_token
    refresh_token_expires_at
    revoked
    ip_address
    device_info
    user_agent
    last_used_at
    created_at
    updated_at
  }
}

mutation UpdateSession($id: uuid!, $session: user_session_set_input!) {
  update_user_session_by_pk(pk_columns: { id: $id }, _set: $session) {
    id
    user_id
    access_token
    access_token_expires_at
    refresh_token
    refresh_token_expires_at
    revoked
    ip_address
    device_info
    user_agent
    last_used_at
    created_at
    updated_at
  }
}

mutation DeleteSession($id: uuid!) {
  delete_user_session_by_pk(id: $id) {
    id
    user_id
    access_token
    access_token_expires_at
    refresh_token
    refresh_token_expires_at
    revoked
    ip_address
    device_info
    user_agent
    last_used_at
    created_at
    updated_at
  }
}

# Session by Access Token
query GetSessionByAccessToken($access_token: String!) {
  user_session(where: { access_token: { _eq: $access_token } }, limit: 1) {
    id
    user_id
    access_token
    access_token_expires_at
    refresh_token
    refresh_token_expires_at
    revoked
    ip_address
    device_info
    user_agent
    last_used_at
    created_at
    updated_at
  }
}

# Session by Refresh Token
query GetSessionByRefreshToken($refresh_token: String!) {
  user_session(where: { refresh_token: { _eq: $refresh_token } }, limit: 1) {
    id
    user_id
    access_token
    access_token_expires_at
    refresh_token
    refresh_token_expires_at
    revoked
    ip_address
    device_info
    user_agent
    last_used_at
    created_at
    updated_at
  }
}
